<!DOCTYPE html>

<head>
	<title>Static REST Access</title>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" media="all" href="./bootstrap/css/bootstrap.css" />
	<!-- <link rel="stylesheet" media="all" href="./main.css" /> -->
	<script type="text/javascript" src="./jquery/jquery-3.3.1.js"></script>
	<script type="text/javascript" src="./bootstrap/js/bootstrap.js"></script>
	<!-- <script type="text/javascript" src="./restClient.js"></script> -->
</head>

<body>


	<div class="container-fluid">
		<div class=“row”>
			<h3>Static REST Access</h3>

			<div class="col-md-12">
				<input type="text" id="feature" name="feature" value="if0009" />
			</div>
			<form id="restForm" action="/heroku/test" method="" enctype="multipart/form-data">
				<div class=“col-md-12”>
					<input type="text" name="term" value="20xx" />
				</div>
				<div class=“col-md-12”>
					<input type="text" name="shareholderId" value="00002" />
				</div>
				<div class=“col-md-12”>
					<input type="text" name="userId" value="miyagi" />
				</div>
				<div class=“col-md-12”>
					<input type="text" name="outputPlan" value="1010" />
				</div>
				<!-- ボタン領域 -->
				<div class=“col-md-4”>
					<input class="btn btn-success" type="button" value="get">GET</button>
				</div>
				<div class=“col-md-4”>
					<input class="btn btn-info" type="button" value="post">POST</button>
				</div>
				<div class=“col-md-4”>
					<input class="btn btn-warning" type="button" value="put">PUT</button>
				</div>
				<div class=“col-md-4”>
					<input class="btn btn-danger" type="button" value="delete">DELETE</button>
				</div>
			</form>
			<div class=“col-md-12”>
				<form action="/" method="get">
					<button class="btn btn-default" type="submit">初期URLへ戻る</button>
				</form>
			</div>

			<!-- 出力領域 -->
			<div class=“col-md-12”>
				<textarea id="result"></textarea>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		window.onload = function load() {
			console.log('load start');
			let buttons = $("#restForm").find('input[type="button"]');
			$(buttons).each(function (index, element) {
				// クリックイベントを設定
				$(element).on('click', createRequest);
			})
			return false;
		}

		/**
		 * リクエスト方法ボタン押下時処理.
		 */
		function createRequest() {
			let form = $(this).closest('form');
			// form.action = 'http://localhost:5000' + form.action;
			// form.method = $(this).val();
			// form.submit();
			var data = {};
			form.find('input[type="text"]').each(function (index, element) {
				// パラメータを集約
				data[element.name] = element.value;
			})
			// Ajax実施
			callAjax(form.attr('action'), $(this).val(), data);
		}

		function callAjax(url, method, data) {
			console.log(url);
			console.log(method);
			console.log(data);

			$.ajax({
				url: 'http://localhost:5000' + url,
				type: method,
				data: JSON.stringify(data),
				contentType: 'application/json',
				dataType: "json",
				success: function (result) {
					// Do something with the result
					$('#result').val(JSON.stringify(result));
				}
			});

			return false;
		}
	</script>
</body>

</html>